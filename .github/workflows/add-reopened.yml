name: Add Reopened Issue to Project
on:
  issues:
    types:
      - reopened

jobs:
  add_to_project:
    runs-on: ubuntu-latest

    steps:
      - name: Get Project ID
        run: |
          PROJECT_URL="https://api.github.com/orgs/Stardust-Labs-MC/projects/1"
          PROJECT_RESPONSE=$(curl -s -H "Accept: application/vnd.github.inertia-preview+json" "$PROJECT_URL")
          PROJECT_ID=$(echo "$PROJECT_RESPONSE" | jq --raw-output '.id')
          echo "PROJECT_ID=$PROJECT_ID" >> $GITHUB_ENV

      - name: Add Issue to Project
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          PROJECT_ID: ${{ env.PROJECT_ID }}
          ISSUE_NUMBER: ${{ github.event.issue.number }}
        run: |
          API_URL="https://api.github.com/projects/$PROJECT_ID/columns/cards"
          ISSUE_URL="https://api.github.com/repos/$GITHUB_REPOSITORY/issues/$ISSUE_NUMBER"
          curl -s -X POST -H "Authorization: Bearer $GITHUB_TOKEN" -H "Content-Type: application/json" -d "{\"content_id\": $ISSUE_NUMBER, \"content_type\": \"Issue\", \"note\": \"Reopened issue\", \"url\": \"$ISSUE_URL\"}" "$API_URL"
